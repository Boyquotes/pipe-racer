[gd_resource type="VisualShader" load_steps=26 format=3 uid="uid://dih7hoj8gkorv"]

[ext_resource type="Texture2D" uid="uid://ds4rnuhypjs8a" path="res://addons/shaderV/examples/godot_logo.png" id="1_4pwe1"]
[ext_resource type="Script" path="res://addons/shaderV/rgba/grayscale.gd" id="2_d0su5"]
[ext_resource type="Script" path="res://addons/shaderV/rgba/normalFromHeightmap.gd" id="3_xer0u"]

[sub_resource type="VisualShaderNodeTexture" id="VisualShaderNodeTexture_86j1i"]
source = 5
texture = ExtResource("1_4pwe1")

[sub_resource type="VisualShaderNodeInput" id="VisualShaderNodeInput_mdmmi"]
output_port_for_preview = 0
input_name = "uv"

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_6uogo"]
operator = 4

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_cukmc"]
default_input_values = [0, 1.0, 1, 1.0]
operator = 3

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_y55mj"]
output_port_for_preview = 0
operator = 3

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_j1mhv"]
operator = 2

[sub_resource type="VisualShaderNodeFloatFunc" id="VisualShaderNodeFloatFunc_xw2gt"]
function = 14

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_302ae"]
output_port_for_preview = 0
default_input_values = [0, 1.0, 1, 1.0]
operator = 3

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_lc3vy"]

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_0wu1j"]
op_type = 0

[sub_resource type="VisualShaderNodeIntParameter" id="VisualShaderNodeIntParameter_dmmxn"]
parameter_name = "Sides"
default_value_enabled = true
default_value = 4

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_rtdst"]
op_type = 0

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_j750p"]
operator = 2

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_2oco7"]
default_input_values = [0, 0.0, 1, 1.0]
operator = 4

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_a10l8"]
operator = 3

[sub_resource type="VisualShaderNodeMix" id="VisualShaderNodeMix_1y5nx"]
output_port_for_preview = 0
default_input_values = [0, Vector3(0, 0, 0), 1, Vector3(1, 1, 1), 2, Vector3(0.5, 0.5, 0.5)]
op_type = 3

[sub_resource type="VisualShaderNodeBooleanParameter" id="VisualShaderNodeBooleanParameter_n78a2"]
parameter_name = "Repeated"
default_value_enabled = true

[sub_resource type="VisualShaderNodeTexture2DParameter" id="VisualShaderNodeTexture2DParameter_6jmcb"]
parameter_name = "Texture"

[sub_resource type="VisualShaderNodeCustom" id="VisualShaderNodeCustom_uf4il"]
default_input_values = [1, 1.0]
initialized = true
script = ExtResource("2_d0su5")

[sub_resource type="VisualShaderNodeCustom" id="VisualShaderNodeCustom_q2iqw"]
default_input_values = [2, Vector3(128, 128, 0), 3, 0.25, 4, true, 5, true, 6, true]
initialized = true
script = ExtResource("3_xer0u")

[sub_resource type="VisualShaderNodeRemap" id="VisualShaderNodeRemap_xotkl"]
default_input_values = [1, 0.0, 2, 1.0, 3, 0.9, 4, 0.4]

[sub_resource type="VisualShaderNodeVectorDecompose" id="VisualShaderNodeVectorDecompose_87jyu"]
default_input_values = [0, Vector2(0, 0)]
op_type = 0

[resource]
code = "shader_type spatial;
render_mode blend_mix, depth_draw_opaque, cull_back, diffuse_lambert, specular_schlick_ggx;

uniform int Sides = 4;
uniform bool Repeated = false;
uniform sampler2D Texture;


// GrayscalePlus
vec3 _grayscaleFunc(vec3 _color_grayscale, float _gray_factor){
	return _color_grayscale * (1.0 - _gray_factor) + (0.21 * _color_grayscale.r + 0.71 * _color_grayscale.g + 0.07 * _color_grayscale.b) * _gray_factor;
}
// NormalFromHeightmap
vec3 _normalFromHeightmapFunc(vec2 _hm_uv, sampler2D _hm_tex, vec2 _hm_size, float _norm_hm_strgth, bool _conv_hm_gray, bool _inv_x_norm, bool _inv_y_norm){
	vec3 _hm_down = textureLod(_hm_tex, _hm_uv + vec2(0.0, 1.0 / _hm_size.y), 0.0).rgb;
	vec3 _hm_up = textureLod(_hm_tex, _hm_uv - vec2(0.0, 1.0 / _hm_size.y), 0.0).rgb;
	vec3 _hm_right = textureLod(_hm_tex, _hm_uv + vec2(1.0 / _hm_size.x, 0.0), 0.0).rgb;
	vec3 _hm_left = textureLod(_hm_tex, _hm_uv - vec2(1.0 / _hm_size.x, 0.0), 0.0).rgb;
	
	if (_conv_hm_gray) {
		_hm_down.r = 0.2126 * _hm_down.r + 0.7152 * _hm_down.g + 0.0722 * _hm_down.b;
		_hm_up.r = 0.2126 * _hm_up.r + 0.7152 * _hm_up.g + 0.0722 * _hm_up.b;
		_hm_right.r = 0.2126 * _hm_right.r + 0.7152 * _hm_right.g + 0.0722 * _hm_right.b;
		_hm_left.r = 0.2126 * _hm_left.r + 0.7152 * _hm_left.g + 0.0722 * _hm_left.b;
	}
	
	float dx = (1.0 - float(_inv_x_norm)) * (_hm_left.r - _hm_right.r) + 
				(float(_inv_x_norm)) * (-_hm_left.r + _hm_right.r);
	float dy = (1.0 - float(_inv_y_norm)) * (_hm_up.r - _hm_down.r) + 
				(float(_inv_y_norm)) * (-_hm_up.r + _hm_down.r);
	
	return normalize(vec3(dx, dy, 1.0 / _norm_hm_strgth));
}

void fragment() {
// Input:28
	vec2 n_out28p0 = UV;


// IntParameter:37
	int n_out37p0 = Sides;


// FloatOp:30
	float n_in30p0 = 1.00000;
	float n_out30p0 = n_in30p0 / float(n_out37p0);


// FloatOp:29
	float n_out29p0 = mod(n_out28p0.x, n_out30p0);


// VectorDecompose:5
	float n_out5p0 = n_out28p0.x;
	float n_out5p1 = n_out28p0.y;


// FloatOp:31
	float n_out31p0 = n_out29p0 / n_out5p1;


// FloatOp:32
	float n_out32p0 = n_out28p0.x * float(n_out37p0);


// FloatFunc:33
	float n_out33p0 = floor(n_out32p0);


// FloatOp:34
	float n_out34p0 = n_out33p0 / float(n_out37p0);


// FloatOp:35
	float n_out35p0 = n_out31p0 + n_out34p0;


// VectorCompose:36
	vec2 n_out36p0 = vec2(n_out35p0, n_out5p1);


// FloatOp:39
	float n_out39p0 = n_out5p0 * float(n_out37p0);


// FloatOp:40
	float n_in40p1 = 1.00000;
	float n_out40p0 = mod(n_out39p0, n_in40p1);


// FloatOp:41
	float n_out41p0 = n_out40p0 / n_out5p1;


// VectorCompose:38
	vec2 n_out38p0 = vec2(n_out41p0, n_out5p1);


// BooleanParameter:43
	bool n_out43p0 = Repeated;


// Mix:42
	vec3 n_out42p0 = mix(vec3(n_out36p0, 0.0), vec3(n_out38p0, 0.0), vec3(n_out43p0 ? 1.0 : 0.0));


	vec4 n_out27p0;
// Texture2D:27
	n_out27p0 = texture(Texture, vec2(n_out42p0.xy));


	vec3 n_out46p0;
// GrayscalePlus:46
	float n_in46p1 = 1.00000;
	{
		n_out46p0 = _grayscaleFunc(vec3(n_out27p0.xyz), n_in46p1);
	}


	float n_out48p0;
// Remap:48
	float n_in48p1 = 0.00000;
	float n_in48p2 = 1.00000;
	float n_in48p3 = 0.90000;
	float n_in48p4 = 0.40000;
	{
		float __input_range = n_in48p2 - n_in48p1;
		float __output_range = n_in48p4 - n_in48p3;
		n_out48p0 = n_in48p3 + __output_range * ((n_out46p0.x - n_in48p1) / __input_range);
	}


	vec3 n_out47p0;
// NormalFromHeightmap:47
	vec3 n_in47p2 = vec3(128.00000, 128.00000, 0.00000);
	float n_in47p3 = 0.25000;
	bool n_in47p4 = true;
	bool n_in47p5 = true;
	bool n_in47p6 = true;
	{
		n_out47p0 = _normalFromHeightmapFunc(n_out42p0.xy, Texture, n_in47p2.xy, n_in47p3, n_in47p4, n_in47p5, n_in47p6);
	}


// Output:0
	ALBEDO = vec3(n_out27p0.xyz);
	ROUGHNESS = n_out48p0;
	SPECULAR = n_out46p0.x;
	NORMAL_MAP = n_out47p0;


}
"
graph_offset = Vector2(1091.4, 925.316)
nodes/fragment/0/position = Vector2(2580, 1440)
nodes/fragment/5/node = SubResource("VisualShaderNodeVectorDecompose_87jyu")
nodes/fragment/5/position = Vector2(380, 1960)
nodes/fragment/27/node = SubResource("VisualShaderNodeTexture_86j1i")
nodes/fragment/27/position = Vector2(1920, 1500)
nodes/fragment/28/node = SubResource("VisualShaderNodeInput_mdmmi")
nodes/fragment/28/position = Vector2(-200, 2100)
nodes/fragment/29/node = SubResource("VisualShaderNodeFloatOp_6uogo")
nodes/fragment/29/position = Vector2(600, 2120)
nodes/fragment/30/node = SubResource("VisualShaderNodeFloatOp_cukmc")
nodes/fragment/30/position = Vector2(380, 2140)
nodes/fragment/31/node = SubResource("VisualShaderNodeFloatOp_y55mj")
nodes/fragment/31/position = Vector2(920, 2040)
nodes/fragment/32/node = SubResource("VisualShaderNodeFloatOp_j1mhv")
nodes/fragment/32/position = Vector2(520, 2300)
nodes/fragment/33/node = SubResource("VisualShaderNodeFloatFunc_xw2gt")
nodes/fragment/33/position = Vector2(660, 2300)
nodes/fragment/34/node = SubResource("VisualShaderNodeFloatOp_302ae")
nodes/fragment/34/position = Vector2(860, 2360)
nodes/fragment/35/node = SubResource("VisualShaderNodeFloatOp_lc3vy")
nodes/fragment/35/position = Vector2(1220, 2080)
nodes/fragment/36/node = SubResource("VisualShaderNodeVectorCompose_0wu1j")
nodes/fragment/36/position = Vector2(1400, 1920)
nodes/fragment/37/node = SubResource("VisualShaderNodeIntParameter_dmmxn")
nodes/fragment/37/position = Vector2(-120, 2420)
nodes/fragment/38/node = SubResource("VisualShaderNodeVectorCompose_rtdst")
nodes/fragment/38/position = Vector2(1280, 1580)
nodes/fragment/39/node = SubResource("VisualShaderNodeFloatOp_j750p")
nodes/fragment/39/position = Vector2(580, 1740)
nodes/fragment/40/node = SubResource("VisualShaderNodeFloatOp_2oco7")
nodes/fragment/40/position = Vector2(780, 1720)
nodes/fragment/41/node = SubResource("VisualShaderNodeFloatOp_a10l8")
nodes/fragment/41/position = Vector2(980, 1800)
nodes/fragment/42/node = SubResource("VisualShaderNodeMix_1y5nx")
nodes/fragment/42/position = Vector2(1640, 1600)
nodes/fragment/43/node = SubResource("VisualShaderNodeBooleanParameter_n78a2")
nodes/fragment/43/position = Vector2(1300, 1720)
nodes/fragment/44/node = SubResource("VisualShaderNodeTexture2DParameter_6jmcb")
nodes/fragment/44/position = Vector2(1400, 1240)
nodes/fragment/46/node = SubResource("VisualShaderNodeCustom_uf4il")
nodes/fragment/46/position = Vector2(2100, 1600)
nodes/fragment/47/node = SubResource("VisualShaderNodeCustom_q2iqw")
nodes/fragment/47/position = Vector2(2000, 1740)
nodes/fragment/48/node = SubResource("VisualShaderNodeRemap_xotkl")
nodes/fragment/48/position = Vector2(2360, 1500)
nodes/fragment/connections = PackedInt32Array(28, 0, 29, 0, 30, 0, 29, 1, 5, 1, 31, 1, 28, 0, 32, 0, 32, 0, 33, 0, 33, 0, 34, 0, 35, 0, 36, 0, 5, 1, 36, 1, 29, 0, 31, 0, 27, 0, 0, 0, 28, 0, 5, 0, 37, 0, 30, 1, 37, 0, 32, 1, 37, 0, 34, 1, 31, 0, 35, 0, 34, 0, 35, 1, 5, 0, 39, 0, 37, 0, 39, 1, 39, 0, 40, 0, 40, 0, 41, 0, 5, 1, 41, 1, 41, 0, 38, 0, 5, 1, 38, 1, 42, 0, 27, 0, 43, 0, 42, 2, 36, 0, 42, 0, 38, 0, 42, 1, 44, 0, 27, 2, 46, 0, 48, 0, 27, 0, 46, 0, 44, 0, 47, 0, 42, 0, 47, 1, 48, 0, 0, 3, 46, 0, 0, 4, 47, 0, 0, 9)
